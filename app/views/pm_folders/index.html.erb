<%= javascript_include_tag '/livetree/live_tree' %>     

<% node_id = params[:node_id]%>
<% content_for :sidebar do %>
	 <%= live_tree :folder_tree, {
                  :initial_data_root => @folder_root,
                  :initial_data_options => { :depth => 2 },
                  :initial_data_whole_tree => false,
                  #:css_class => "sidebar_tree",
                  :preload_items => false,
                  :allow_click_branch => true,
                  :on_click_item => "onClickItem(item.id)"
                  }
     %>
     <script type="text/javascript" charset="utf-8">
      function onClickItem(folderID) {
        new Ajax.Updater('list_view', '<%= pm_lib_pm_folders_path(@pm_lib) %>/'+folderID, { method: 'get', asynchronous:true, evalScripts:true})
      }

    <%if node_id%>
      Event.observe(window,"load",function(event){
          var loadId = <%= node_id%>
          folderTree.expandItem(loadId)
          onClickItem(loadId)
      });
    <% end %>
  </script>
<% end %>
<div id='list_view'>
    <% if node_id %>
	    <h1>正在加载，请稍等。。。</h1>
	<%else%>
		<center><h1>请点击左侧"对象树"</h1></center>
    <%end%>
</div>

